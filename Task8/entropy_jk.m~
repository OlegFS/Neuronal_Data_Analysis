function H = entropy_jk(p)
% function H = entropy_jk(p)
%   p   vector with observed frequencies of all words
%   H   jackknife estimate of entropy

% jack-knifed entropy estimator (paninski, p. 1198)


N = 100;
for i=1:100
    samp = sa;  % draw a random sample from the uniform distribution
sampHist = accumarray(samp',1);
%ps = p(randi(length(p),length(p),1));
%ph = ps./sum(ps);
%H_perm(i) = - nansum(ph.*log2(ph));
end

ph = p./sum(p);
D = mean(H_perm);
H = - N*nansum(ph.*log2(ph)) - ((N-1)*D);
